%==========================================================================
%Example: A model of neural stem cell regulation (NSCR)
%--------------------------------------------------------------------------
%-------The inputs of the model reduction----------------------------------
%---------Z: the sxc complex composition matrix----------------------------
%---------B: the cxr incidence matrix--------------------------------------
%---------k: the vector of rate constants of of length r-------------------
%---------x_0: the vector of initial concentrations of length s------------
%---------Maximum_error: the maximum admissible value of the error integral
%==========================================================================
        Z = [1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;   
             0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;  
             0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0;   
             0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0;  
             0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;   
             0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0;  
             0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0;   
             0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0;  
             0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;   
             0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;  
             0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0;  
             0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0;  
             0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0;   
             0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;  
             0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0;   
             0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0;  
             0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;   
             0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0;  
             0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;  
             0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0;  
             0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1]; 
%--------------------------------------------------------------------------
        B= [-1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0;  
             1 -1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0;     
             0  0 -1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0;  
             0  0  1 -1 -1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0;  
             0  0  0  0  1 -1  0  0  0  0  1 -1  0  0  0  0  0  0  1 -1;  
             0  0  0  0  0  0 -1  1  0  0  0  0  0  0  0  0  0  0  0  0; 
             0  0  0  0  0  0  1 -1  0  0  0  0  0  0  0  0  0  0  0  0; 
             0  0  0  0  0  0  0  0 -1  1  0  0  0  0  0  0  0  0  0  0; 
             0  0  0  0  0  0  0  0  1 -1 -1  1  0  0  0  0  0  0  0  0; 
             0  0  0  0  0  0  0  0  0  0  0  0 -1  1  0  0  0  0  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  1 -1  0  0  0  0  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  0  0 -1  1  0  0  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 -1  0  0  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 -1  1  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 -1  0  0;  
             0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 -1  1]; 
%--------------------------------------------------------------------------
        x_0 = [5;5;0;0;0;5;0;0;5;5;0;5;0;5;5;0;5;5;0;5;5];
%--------------------------------------------------------------------------
        k = [sqrt(2)*5/101; sqrt(2)*5/101; 1; 1; 1; 1; 1; 1; 1/101; 1/101; 
             1; 1; 1; 1; 1; 1; 1/101; 1/101; 1;1]; 
%--------------------------------------------------------------------------
Maximum_error = 0.15;
%-------------------------------------------------------------------------- 
save('NSCR')
%==========================================================================
